# mcg-api-examples
Examples for connecting to the MCG API taken from the API Getting Started manual

(c) Copyright 2023 Premier Heart, LLC


### Basic API Connectivity

* simple_connection.py - Tests that a connection can be made to the API server
```
bash# MCG_API_TOKEN_FILE='.token/mcg_api_jwt.dat' python simple_connection.py
Connecting to unused endpoint. Should print 'ERROR /':
ERROR /
```

* error_handling.py - Demonstrates how to handle various connection errors
```
bash# MCG_API_TOKEN_FILE='.token/mcg_api_jwt.dat' python error_handling.py
[01] Connecting to invalid server
 ... Caught exception
[02] Connecting to invalid path
 ... Caught 401 error
[03] Connecting with empty token
 ... Caught 401 error
[04] Connecting with invalid token
 ... Caught 401 error
[05] Connecting with bad/expired token
 ... Caught 401 error
[06] Connecting with valid token and empty request
 ... Caught error 'API request error': Missing 'analysis' in request 
[07] Connecting with valid token and incorrect type
 ... Caught error 'API request error': Unsupported object type 'MyBrokenType 
[08] Connecting with valid token and invalid request
 ... Caught error 'API request error': Missing 'input' in request 
[09] Connecting with valid token and empty request input
 ... Caught error 'Insufficient input data provided': 1+ inputs required 
[10] Connecting with valid token and invalid request input
 ... Caught error 'API request error': Unsupported object type 'MyBrokenType 
[11] Connecting with valid token and invalid analysis type
 ... Caught error: Extension not found
```    

* basic_analysis_request.py - Demonstrates how to send an AnalysisRequest to the API server. This uses random data for the ECG inputs, which may result in an Error object being returned instead of an AnalysisResult.
```
bash# MCG_API_TOKEN_FILE='.token/mcg_api_jwt.dat' python basic_analysis_request.py
Analysis Results:
	object-type: analysis-result
	locale: en-US
	encoding: utf-8
	framework: {'name': 'BSIA', 'version': '1.0.1', 'description': 'BioSignal Information Analysis framework', 'notice': 'Experimental software: NOT FOR CLINICAL USE. (c) Copyright 2022 Premier Heart, LLC'}
	id: None
	results: {'source': 'mcg-avg', 'sample': '2', 'category': 'N/A', 'positive':
/* ... OMITTED ... */
}]'}]
	warnings: []
```

* send_ecg_files.py - Demonstrates how to send ECG JSON files for analysis and display the results.
```
bash# MCG_API_TOKEN_FILE='.token/mcg_api_jwt.dat' python send_ecg_files.py
Read input: /home/ph/projects/mcg-api-examples/data/ecg_1.json
Read input: /home/ph/projects/mcg-api-examples/data/ecg_2.json
Read input: /home/ph/projects/mcg-api-examples/data/ecg_3.json
Results Summary:
	object-type: analysis-result
	locale: en-US
	encoding: utf-8
	framework: {'name': 'BSIA', 'version': '1.0.1', 'description': 'BioSignal Information Analysis framework', 'notice': 'Experimental software: NOT FOR CLINICAL USE. (c) Copyright 2022 Premier Heart, LLC'}
	id: None
	Diagnosis generated by mcg-avg using input 2 as a representative sample
	MCG Category: N/A
	Conditions detected (positives):
		Impression : 5.0
		Disease Severity : 6.5
/* ... OMITTED ... */
	Tracing Quality:
		0 : 90
		1 : 90
		2 : 90
	warnings: []
Attachments:
```
* multiple_output_request.py - Demonstrates how to request multiple output files, which will be included in the AnalysisResults object as attachments.
```
bash# MCG_API_TOKEN_FILE='.token/mcg_api_jwt.dat' python multiple_output_request.py
Read input: /home/ph/projects/mcg-api-examples/data/ecg_1.json
Read input: /home/ph/projects/mcg-api-examples/data/ecg_2.json
Read input: /home/ph/projects/mcg-api-examples/data/ecg_3.json
Results Summary:
	object-type: analysis-result
	locale: en-US
	encoding: utf-8
	framework: {'name': 'BSIA', 'version': '1.0.1', 'description': 'BioSignal Information Analysis framework', 'notice': 'Experimental software: NOT FOR CLINICAL USE. (c) Copyright 2022 Premier Heart, LLC'}
	id: None
	Diagnosis generated by mcg-avg using input 2 as a representative sample
	MCG Category: N/A
	Conditions detected (positives):
		Impression : 5.0
		Disease Severity : 6.5
/* ... OMITTED ... */
	Tracing Quality:
		0 : 90
		1 : 90
		2 : 90
	warnings: []
Attachments:
	[0] result-group from result-json for input '1' : application/x-java-object (in-memory JSON object)
	[1] result-sample from result-json for input '0' : application/x-java-object (in-memory JSON object)
	[2] result-sample from result-json for input '1' : application/x-java-object (in-memory JSON object)
	[3] result-sample from result-json for input '2' : application/x-java-object (in-memory JSON object)
	[4] result-explain-group from result-explain-json for input '1' : application/x-java-object (in-memory JSON object)
	[5] result-explain-sample from result-explain-json for input '0' : application/x-java-object (in-memory JSON object)
	[6] result-explain-sample from result-explain-json for input '1' : application/x-java-object (in-memory JSON object)
	[7] result-explain-sample from result-explain-json for input '2' : application/x-java-object (in-memory JSON object)
	[8] feature-group from feature-json for input '1' : application/x-java-object (in-memory JSON object)
	[9] feature-sample from feature-json for input '0' : application/x-java-object (in-memory JSON object)
	[10] feature-sample from feature-json for input '1' : application/x-java-object (in-memory JSON object)
	[11] feature-sample from feature-json for input '2' : application/x-java-object (in-memory JSON object)
	[12] transform-sample from transform-json for input '0' : application/x-java-object (in-memory JSON object)
	[13] transform-sample from transform-json for input '1' : application/x-java-object (in-memory JSON object)
	[14] transform-sample from transform-json for input '2' : application/x-java-object (in-memory JSON object)
	[15] transform-heatmap-amp.V5 from transform-heatmap for input '0,1,2' : image/svg+xml (base64-encoded 104719-byte file)
	[16] transform-heatmap-amp.II from transform-heatmap for input '0,1,2' : image/svg+xml (base64-encoded 104635-byte file)
	[17] transform-heatmap-aps.V5 from transform-heatmap for input '0,1,2' : image/svg+xml (base64-encoded 113311-byte file)
	[18] transform-heatmap-aps.II from transform-heatmap for input '0,1,2' : image/svg+xml (base64-encoded 112693-byte file)
	[19] transform-heatmap-ccr.(V5,II) from transform-heatmap for input '0,1,2' : image/svg+xml (base64-encoded 156335-byte file)
	[20] transform-heatmap-coh.(V5,II) from transform-heatmap for input '0,1,2' : image/svg+xml (base64-encoded 54395-byte file)
	[21] transform-heatmap-imr.(V5,II) from transform-heatmap for input '0,1,2' : image/svg+xml (base64-encoded 107149-byte file)
	[22] transform-heatmap-psa.(V5,II) from transform-heatmap for input '0,1,2' : image/svg+xml (base64-encoded 76549-byte file)
	[23] transform-heatmap-xar.(V5,II) from transform-heatmap for input '0,1,2' : image/svg+xml (base64-encoded 66321-byte file)
	[24] transform-heatmap-cps.(V5,II) from transform-heatmap for input '0,1,2' : image/svg+xml (base64-encoded 113602-byte file)
	[25] report from report-json for input '0,1,2' : application/x-java-object (in-memory JSON object)
```
* tracing_quality_request.py - Demonstrates how to perform an ECG Tracing Quality analysis
```
bash# MCG_API_TOKEN_FILE='.token/mcg_api_jwt.dat' python tracing_quality_request.py
Read input: /home/ph/projects/mcg-api-examples/data/ecg_1.json
Read input: /home/ph/projects/mcg-api-examples/data/ecg_2.json
Read input: /home/ph/projects/mcg-api-examples/data/ecg_3.json
Results Summary:
	object-type: analysis-result
	locale: en-US
	encoding: utf-8
	framework: {'name': 'BSIA', 'version': '1.0.1', 'description': 'BioSignal Information Analysis framework', 'notice': 'Experimental software: NOT FOR CLINICAL USE. (c) Copyright 2022 Premier Heart, LLC'}
	id: None
	Tracing Quality: 90
		**  Baseline: 100 Noise: 90 Range: 99
		V5  Baseline: 100 Noise: 90 Range: 99
		II  Baseline: 100 Noise: 100 Range: 100
	ECG Details:
		V5  Count: 8192  High: 2384  Low: 128  Baseline: 787  Total: 6447252  Peak Count: 753  Voltage: 5.64  PPV: 2256
		II  Count: 8192  High: 1841  Low: 193  Baseline: 693  Total: 5681463  Peak Count: 567  Voltage: 4.12  PPV: 1648
	warnings: []
```

### Analysis of API Output
These programs take an AnalysisResults JSON file as in put. In the following examples, the automatically-saved output of multiple_output_request.py has been used.

* analyze_result_diagnoses.py - This demonstrates how to load the contents of the Diagnosis Matrix and of **results-json** attachments into a Pandas dataframe. For each dataframe, a summary is printed and a histogram is plotted. Note that the contents of **results-json** are for research purposes only, and should not be interpreted without guidance from Premier Heart staff.
```
bash# python analyze_result_diagnoses.py data/analysis-results.multiple-outputs.example.json
DIAGNOSIS MATRIX:
  id Impression (text) Ischemia  Disease Severity  Ischemic Disease Severity  \
0  0          Abnormal                        6.5                        0.0   
1  1          Abnormal                        6.5                        0.0   
2  2          Abnormal                        6.5                        0.0   
/* ... OMITTED ... */
INPUT 0
        (mcg-pre) MCG Preliminary Analysis Algorithm
                - (HR) Heart Rate : 65
                + (rA) Ventricular Hypertrophy (raw) : 0.16
                + (A) Ventricular Hypertrophy : 0.16
                + (rC) Ischemia (raw) : 0.18
                + (C) Ischemia : 0.21
/* ... OMITTED ... */
				 MCG Ischemia Analysis
   CAD1  CAD2  CAD3  CAD4  CAD5  CAD6  CAD7  CAD8  CAD9  CAD10  CAD11  CAD12  \
0     1     0     0     0     0     0     0     0     0      0      0      0
1     1     0     0     0     0     0     0     0     0      0      0      0
2     1     0     0     0     0     0     0     0     0      0      0      0

   CAD13  CAD14  NCI1  NCI2  NCI3  NCI4  NCI5  NCI6  NCI7  NCI8  NCI9  NCI10  \
0      0      0     0     0     0     0     0     0     0     0     0      0
1      0      0     0     0     0     0     0     0     0     0     0      0
2      0      0     0     0     0     0     0     0     0     0     0      0

   NCI11  NCI12  NCI13  NCI14  NCI15  NCI  CAD  C
0      0      0      0      0      0    0    1  1
1      0      0      0      0      0    0    1  1
2      0      0      0      0      0    0    1  1
       CAD1  CAD2  CAD3  CAD4  CAD5  CAD6  CAD7  CAD8  CAD9  CAD10  CAD11  \
count   3.0   3.0   3.0   3.0   3.0   3.0   3.0   3.0   3.0    3.0    3.0
mean    1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0    0.0    0.0
std     0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0    0.0    0.0
min     1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0    0.0    0.0
25%     1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0    0.0    0.0
50%     1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0    0.0    0.0
75%     1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0    0.0    0.0
max     1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0    0.0    0.0

       CAD12  CAD13  CAD14  NCI1  NCI2  NCI3  NCI4  NCI5  NCI6  NCI7  NCI8  \
count    3.0    3.0    3.0   3.0   3.0   3.0   3.0   3.0   3.0   3.0   3.0
mean     0.0    0.0    0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
std      0.0    0.0    0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
min      0.0    0.0    0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
25%      0.0    0.0    0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
50%      0.0    0.0    0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
75%      0.0    0.0    0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
max      0.0    0.0    0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0

       NCI9  NCI10  NCI11  NCI12  NCI13  NCI14  NCI15  NCI  CAD    C
count   3.0    3.0    3.0    3.0    3.0    3.0    3.0  3.0  3.0  3.0
mean    0.0    0.0    0.0    0.0    0.0    0.0    0.0  0.0  1.0  1.0
std     0.0    0.0    0.0    0.0    0.0    0.0    0.0  0.0  0.0  0.0
min     0.0    0.0    0.0    0.0    0.0    0.0    0.0  0.0  1.0  1.0
25%     0.0    0.0    0.0    0.0    0.0    0.0    0.0  0.0  1.0  1.0
50%     0.0    0.0    0.0    0.0    0.0    0.0    0.0  0.0  1.0  1.0
75%     0.0    0.0    0.0    0.0    0.0    0.0    0.0  0.0  1.0  1.0
max     0.0    0.0    0.0    0.0    0.0    0.0    0.0  0.0  1.0  1.0
MCG Disease Severity Analysis
/* ... OMITTED ... */
```
Example of histogram for Diagnosis Matrix:
![Diagnosis Matrix histogram](images/diagnosis-matrix-df-histogram.png?raw=true "Diagnosis Matrix histogram")
Example of histogram for the Ischemia diagnosis algorithm results:
![Ischemia Algorithm histogram](images/ischemia-df-histogram.png?raw=true "Ischemia histogram")

* analyze_result_transforms.py - Demonstrates how to load the contents of **transform-json** into a Pandas dataframe. As an example analysis, the Frequency Response of lead II is calculated. 
```
bash# python analyze_result_transforms.py   data/analysis-results.multiple-outputs.example.json
(aps) auto power spectrum of Signal V5
      frequency domain: power peaks in signal
           0         1          2    ...       125  126       127
count      3.0  3.000000   3.000000  ...  3.000000  3.0  3.000000
mean   32765.0  4.000000  11.666667  ...  2.666667  2.0  1.333333
std        0.0  2.645751   3.214550  ...  0.577350  0.0  0.577350
min    32765.0  2.000000   8.000000  ...  2.000000  2.0  1.000000
25%    32765.0  2.500000  10.500000  ...  2.500000  2.0  1.000000
50%    32765.0  3.000000  13.000000  ...  3.000000  2.0  1.000000
75%    32765.0  5.000000  13.500000  ...  3.000000  2.0  1.500000
max    32765.0  7.000000  14.000000  ...  3.000000  2.0  2.000000

[8 rows x 128 columns]

(aps) auto power spectrum of Signal II
      frequency domain: power peaks in signal
/* ... OMITTED ... */
Frequency Response (II):
            0    1    2    3    ...         124   125        126  127
count  3.000000  3.0  3.0  3.0  ...    3.000000   3.0   3.000000  3.0
mean   2.764980  0.0  0.0  0.0  ...  326.200515  15.0   3.333333  0.0
std    0.002138  0.0  0.0  0.0  ...   23.721900   4.0   5.773503  0.0
min    2.762648  0.0  0.0  0.0  ...  299.130435  11.0   0.000000  0.0
25%    2.764047  0.0  0.0  0.0  ...  317.620773  13.0   0.000000  0.0
50%    2.765446  0.0  0.0  0.0  ...  336.111111  15.0   0.000000  0.0
75%    2.766146  0.0  0.0  0.0  ...  339.735556  17.0   5.000000  0.0
max    2.766847  0.0  0.0  0.0  ...  343.360000  19.0  10.000000  0.0

[8 rows x 128 columns]  
```

### Displaying API output
These programs take an AnalysisResults JSON file as in put. In the following examples, the automatically-saved output of multiple_output_request.py has been used.
* extract-transform-heatmaps.py - Demonstrates how to extract base64-encoded attachments and write them to a file. This exports the SVG files generated by the  **transform-heatmap** output extension.
```
bash# python extract-transform-heataps.py data/analysis-results.multiple-outputs.example.json 
Writing images/transform-heatmap-amp.V5.svg...
Writing images/transform-heatmap-amp.II.svg...
Writing images/transform-heatmap-aps.V5.svg...
Writing images/transform-heatmap-aps.II.svg...
Writing images/transform-heatmap-ccr.(V5,II).svg...
Writing images/transform-heatmap-coh.(V5,II).svg...
Writing images/transform-heatmap-imr.(V5,II).svg...
Writing images/transform-heatmap-psa.(V5,II).svg...
Writing images/transform-heatmap-xar.(V5,II).svg...
Writing images/transform-heatmap-cps.(V5,II).svg...
Done.
```
Example heatmap : Coherence
![Coherence heatmap](images/coherence-heatmap.svg?raw=true "Coherence heatmap")

* transform_heatmap_output.py - Demonstrates generating the transform heatmaps locally, using matplotlib.
```
bash# python extract-transform-heataps.py data/analysis-results.multiple-outputs.example.json 
Plotting aps.V5. Press Ctrl-w to close.
Plotting aps.II. Press Ctrl-w to close.
Plotting amp.V5. Press Ctrl-w to close.
Plotting amp.II. Press Ctrl-w to close.
Plotting cps.(V5,II). Press Ctrl-w to close.
Plotting ccr.(V5,II). Press Ctrl-w to close.
Plotting imr.(V5,II). Press Ctrl-w to close.
Plotting psa.(V5,II). Press Ctrl-w to close.
Plotting xar.(V5,II). Press Ctrl-w to close.
Plotting coh.(V5,II). Press Ctrl-w to close.
```
Example heatmap : Coherence
![Coherence heatmap](images/coherence-heatmap.png?raw=true "Coherence heatmap")
Note that the colormap in matplotlib differs slighty from that used by the server to generate the SVG. The Matplotlib version is considered more canonical.
* transform_topo_plot.py
```
bash# python transform_topo_plot.py data/analysis-results.multiple-outputs.example.json 
Plotting aps.V5. Press Ctrl-w to close.
Plotting aps.II. Press Ctrl-w to close.
Plotting amp.V5. Press Ctrl-w to close.
Plotting amp.II. Press Ctrl-w to close.
Plotting cps.(V5,II). Press Ctrl-w to close.
Plotting ccr.(V5,II). Press Ctrl-w to close.
Plotting imr.(V5,II). Press Ctrl-w to close.
Plotting psa.(V5,II). Press Ctrl-w to close.
Plotting xar.(V5,II). Press Ctrl-w to close.
Plotting coh.(V5,II). Press Ctrl-w to close.
```
Example Topo Plot : Coherence
![Coherence topo](images/coherence-topo_plot.png?raw=true "Coherence topo")

* generate_pdf_report.py - Demonstrates generating a simple PDF report from the Diagnosis Matrix and the **report-json** output extension.
```
bash# python generate_pdf_report.py  data/analysis-results.multiple-outputs.example.json 
```
Example PDF report : First page
![PDF Report](images/mcg-pdf-report-page-1.png?raw=true "PDF Report")


### Advanced Analysis Types
These analyses are considered experimental, and their implementation may change.
* differential_analysis_request.py - Demonstrates how to request a differential
diagnosis analysis (e.g. pre/post-treatment), and plot the results. Note that
the standard MCG Analysis outputs for transforms and results are available as 
attachments.
```
bash# MCG_API_TOKEN_FILE='.token/mcg_api_jwt.dat' python differential_analysis_request.py
Read input: /home/ph/projects/mcg-api-examples/data/ecg_pre_1.json
Read input: /home/ph/projects/mcg-api-examples/data/ecg_pre_2.json
Read input: /home/ph/projects/mcg-api-examples/data/ecg_pre_3.json
Read input: /home/ph/projects/mcg-api-examples/data/ecg_pre_4.json
Read input: /home/ph/projects/mcg-api-examples/data/ecg_pre_5.json
Read input: /home/ph/projects/mcg-api-examples/data/ecg_post_1.json
Read input: /home/ph/projects/mcg-api-examples/data/ecg_post_2.json
Read input: /home/ph/projects/mcg-api-examples/data/ecg_post_3.json
Results Summary:
	object-type: analysis-result
	locale: en-US
	encoding: utf-8
	framework: {'name': 'BSIA', 'version': '1.0.1', 'description': 'BioSignal Information Analysis framework', 'notice': 'Experimental software: NOT FOR CLINICAL USE. (c) Copyright 2022 Premier Heart, LLC'}
	id: None
	Comment: (FAKE DATA) Generated by differential_analysis_request.py
	Tracing Quality:
		ecg_pre_1 : 7
		ecg_pre_2 : 0
		ecg_pre_3 : 0
		ecg_pre_4 : 0
		ecg_pre_5 : 0
		ecg_post_1 : 35
		ecg_post_2 : 29
		ecg_post_3 : 28
	ECG Details:
/* ... OMITTED ... */
Attachments:
	[0] result-diff-csv from result-diff-csv for input 'ecg_pre_1,ecg_pre_2,ecg_pre_3,ecg_pre_4,ecg_pre_5,ecg_post_1,ecg_post_2,ecg_post_3' : text/csv
	[1] result-differential from result-json for input '' : application/x-java-object
	[2] result-group from result-json for input 'pre' : application/x-java-object
	[3] result-sample from result-json for input 'ecg_pre_1' : application/x-java-object
	[4] result-sample from result-json for input 'ecg_pre_2' : application/x-java-object
	[5] result-sample from result-json for input 'ecg_pre_3' : application/x-java-object
	[6] result-sample from result-json for input 'ecg_pre_4' : application/x-java-object
	[7] result-sample from result-json for input 'ecg_pre_5' : application/x-java-object
	[8] result-group from result-json for input 'post' : application/x-java-object
	[9] result-sample from result-json for input 'ecg_post_1' : application/x-java-object
	[10] result-sample from result-json for input 'ecg_post_2' : application/x-java-object
	[11] result-sample from result-json for input 'ecg_post_3' : application/x-java-object
	[12] transform-heatmap-amp.V5 from transform-heatmap for input 'ecg_pre_1,ecg_pre_2,ecg_pre_3,ecg_pre_4,ecg_pre_5,ecg_post_1,ecg_post_2,ecg_post_3' : image/svg+xml
	[13] transform-heatmap-amp.II from transform-heatmap for input 'ecg_pre_1,ecg_pre_2,ecg_pre_3,ecg_pre_4,ecg_pre_5,ecg_post_1,ecg_post_2,ecg_post_3' : image/svg+xml
	[14] transform-heatmap-aps.V5 from transform-heatmap for input 'ecg_pre_1,ecg_pre_2,ecg_pre_3,ecg_pre_4,ecg_pre_5,ecg_post_1,ecg_post_2,ecg_post_3' : image/svg+xml
	[15] transform-heatmap-aps.II from transform-heatmap for input 'ecg_pre_1,ecg_pre_2,ecg_pre_3,ecg_pre_4,ecg_pre_5,ecg_post_1,ecg_post_2,ecg_post_3' : image/svg+xml
	[16] transform-heatmap-ccr.(V5,II) from transform-heatmap for input 'ecg_pre_1,ecg_pre_2,ecg_pre_3,ecg_pre_4,ecg_pre_5,ecg_post_1,ecg_post_2,ecg_post_3' : image/svg+xml
	[17] transform-heatmap-coh.(V5,II) from transform-heatmap for input 'ecg_pre_1,ecg_pre_2,ecg_pre_3,ecg_pre_4,ecg_pre_5,ecg_post_1,ecg_post_2,ecg_post_3' : image/svg+xml
	[18] transform-heatmap-imr.(V5,II) from transform-heatmap for input 'ecg_pre_1,ecg_pre_2,ecg_pre_3,ecg_pre_4,ecg_pre_5,ecg_post_1,ecg_post_2,ecg_post_3' : image/svg+xml
	[19] transform-heatmap-psa.(V5,II) from transform-heatmap for input 'ecg_pre_1,ecg_pre_2,ecg_pre_3,ecg_pre_4,ecg_pre_5,ecg_post_1,ecg_post_2,ecg_post_3' : image/svg+xml
	[20] transform-heatmap-xar.(V5,II) from transform-heatmap for input 'ecg_pre_1,ecg_pre_2,ecg_pre_3,ecg_pre_4,ecg_pre_5,ecg_post_1,ecg_post_2,ecg_post_3' : image/svg+xml
	[21] transform-heatmap-cps.(V5,II) from transform-heatmap for input 'ecg_pre_1,ecg_pre_2,ecg_pre_3,ecg_pre_4,ecg_pre_5,ecg_post_1,ecg_post_2,ecg_post_3' : image/svg+xml
	[22] transform-sample from transform-json for input 'ecg_pre_1' : application/x-java-object
	[23] transform-sample from transform-json for input 'ecg_pre_2' : application/x-java-object
	[24] transform-sample from transform-json for input 'ecg_pre_3' : application/x-java-object
	[25] transform-sample from transform-json for input 'ecg_pre_4' : application/x-java-object
	[26] transform-sample from transform-json for input 'ecg_pre_5' : application/x-java-object
	[27] transform-sample from transform-json for input 'ecg_post_1' : application/x-java-object
	[28] transform-sample from transform-json for input 'ecg_post_2' : application/x-java-object
	[29] transform-sample from transform-json for input 'ecg_post_3' : application/x-java-object
Diff:
groups|inputs|operation|Atrial Fibrillation|Biventricular Hypertrophy|Bradycardia|Cardio Myopathy|Congenital HD|Decreased Myocardial Compliance|Disease Severity|Disease Severity Adjusted Score|Ejection Fraction|Fibrillation|Global Asynchrony|Global Ischemia|Global Ischemia (borderline)|Impression (text)|Incipient Arrhythmia|Increased Myocardial Compliance|Ischemia|Ischemic Disease Severity|Left Ventricular Hypertrophy|Local Asynchrony|Local Ischemia|Local Ischemia (borderline)|Myocardial Infarct|Myocardial Remodelling|Myocarditis|Potential Fibrillation|Power Failure|Pulmonary HD|Rheumatic HD|Right Ventricular Hypertrophy|Signal A lags behind signal B (global)|Signal A lags behind signal B (local)|Signal B lags behind signal A (global)|Signal B lags behind signal A (local)|Tachycardia|Ventricular Arrhythmia|Ventricular Fibrillation|Ventricular Hypertrophy
pre||I|-|-|-|+|X|X|+|+|X|X|+|X|-|+|X|X|X|+|-|-|X|-|+|+|+|-|-|-|X|-|+|-|-|-|-|X|X|-
post||I|X|X|X|-|-|-|+|+|-|+|-|-|-|+|X|X|X|X|-|-|X|-|+|+|+|X|-|X|X|X|-|-|-|-|-|-|-|+
/* ... OMITTED ... */
```
Example Differential Diagnosis Plot
![Differential Diagnosis](images/differential-diagnosis-plot.png?raw=true "Differential Diagnosis")

* diagnosis_trace.py - Shows how to display the tree of a Diagnosis Trace 
output. The Diagnosis Trace is used to determine how a particular result was 
arrived at by the analysis software. 
```
bash# MCG_API_TOKEN_FILE='.token/mcg_api_jwt.dat' python diagnosis_trace.py
Read input: /home/ph/projects/mcg-api-examples/data/ecg_1.json
Read input: /home/ph/projects/mcg-api-examples/data/ecg_2.json
Read input: /home/ph/projects/mcg-api-examples/data/ecg_3.json
Results Summary:
	object-type: analysis-result
	locale: en-US
	encoding: utf-8
	framework: {'name': 'BSIA', 'version': '1.0.1', 'description': 'BioSignal Information Analysis framework', 'notice': 'Experimental software: NOT FOR CLINICAL USE. (c) Copyright 2022 Premier Heart, LLC'}
	id: None
	Comment: (FAKE DATA) Generated by diagnosis_trace.py
	Diagnosis generated by mcg-avg using input ecg_3 as a representative sample
	MCG Category: N/A
	Conditions detected (positives):
		Impression : 5.0
		Disease Severity : 6.5
		Disease Severity Adjusted Score : 8.0
		Ventricular Hypertrophy : 1.0
		Left Ventricular Hypertrophy : 1.0
		Rheumatic HD : 1.0
		Congenital HD : 1.0
		Myocardial Infarct : 1.0
		Myocarditis : 1.0
		Myocardial Remodelling : 1.0
		Increased Myocardial Compliance : 1.0
	Conditions not detected (negatives):
		Ischemic Disease Severity : 0.0
		Biventricular Hypertrophy : 0.0
		Right Ventricular Hypertrophy : 0.0
		Ischemia : 0.0
		Pulmonary HD : 0.0
		Cardio Myopathy : 0.0
		Ejection Fraction : 0.0
		Decreased Myocardial Compliance : 0.0
		Fibrillation : 0.0
		Atrial Fibrillation : 0.0
		Ventricular Fibrillation : 0.0
		Potential Fibrillation : 0.0
		Ventricular Arrhythmia : 0.0
		Incipient Arrhythmia : 0.0
		Local Asynchrony : 0.0
		Power Failure : 0.0
		Global Ischemia : 0.0
		Local Ischemia : 0.0
		Global Ischemia (borderline) : 0.0
		Local Ischemia (borderline) : 0.0
	Tracing Quality:
		ecg_1 : 90
		ecg_2 : 90
		ecg_3 : 90
	warnings: []
Attachments:
	[0] result-group from result-json for input 'screen' : application/x-java-object (in-memory JSON object)
	[1] result-sample from result-json for input 'ecg_1' : application/x-java-object (in-memory JSON object)
	[2] result-sample from result-json for input 'ecg_2' : application/x-java-object (in-memory JSON object)
	[3] result-sample from result-json for input 'ecg_3' : application/x-java-object (in-memory JSON object)
	[4] result-explain-group from result-explain-json for input 'screen' : application/x-java-object (in-memory JSON object)
	[5] result-explain-sample from result-explain-json for input 'ecg_1' : application/x-java-object (in-memory JSON object)
	[6] result-explain-sample from result-explain-json for input 'ecg_2' : application/x-java-object (in-memory JSON object)
	[7] result-explain-sample from result-explain-json for input 'ecg_3' : application/x-java-object (in-memory JSON object)
Diagnosis Trace:
ecg_1
 |- Impression (text)
    |- MCG Primary Analysis: Impression (text)
        |- MCG Impression Analysis: Impression (text)
                |- MCG Impression Analysis: Impression
                                |- MCG Impression Analysis: Abnormal
                                                                |- auto power spectrum V5: A5 (10.0)
                                                                |- phase shift angle : P+ (10.0)
                                                                |- phase shift angle : P- (10.0)
                                                                |- phase shift angle : WW (10.0)
 |- Disease Severity
    |- MCG Primary Analysis: Disease Severity
        |- MCG Disease Severity Analysis: Disease Severity Score
                |- impulse response (V5,II): Bat1 (1.0)
                |- cross correlation (V5,II): Snail1 (1.0)
                |- phase shift angle (V5,II): Dragon1 (1.0)
                |- auto power spectrum II: Camel1 (1.0)
 |- Disease Severity Adjusted Score
    |- MCG Primary Analysis: Disease Severity Adjusted Score
        |- MCG Disease Severity Analysis: Disease Severity Adjusted Score
                |- auto power spectrum II: Camel1 (1.0)
                |- cross correlation (V5,II): Snail1a (1.0)
                |- cross correlation (V5,II): Snail1b (1.0)
                |- cross correlation (V5,II): Snail1c (1.0)
                |- impulse response (V5,II): Bat1a (1.0)
                |- impulse response (V5,II): Bat1b (1.0)
                |- phase shift angle (V5,II): Dragon1a (1.0)
                |- phase shift angle (V5,II): Dragon1b (1.0)
 |- Myocardial Infarct
    |- MCG Secondary Analysis: Myocardial Infarct
        |- phase shift angle (V5,II): WW (1.0)
        |- cross correlation (V5,II): Rn (1.0)
        |- MCG Preliminary Analysis: Myocardial Infarct
 |- Ventricular Hypertrophy
    |- MCG Secondary Analysis: Ventricular Hypertrophy
        |- auto power spectrum V5: A5 (1.0)
        |- MCG Preliminary Analysis: Ventricular Hypertrophy
        |- MCG Secondary Analysis: Left Ventricular Hypertrophy
 |- Left Ventricular Hypertrophy
    |- MCG Secondary Analysis: Left Ventricular Hypertrophy
 |- Congenital HD
    |- MCG Secondary Analysis: Congenital HD
        |- MCG Preliminary Analysis: Congenital HD
 |- Rheumatic HD
    |- MCG Secondary Analysis: Rheumatic HD
        |- MCG Preliminary Analysis: Rheumatic HD
 |- Myocarditis
    |- MCG Secondary Analysis: Myocarditis
        |- MCG Preliminary Analysis: Myocarditis
 |- Myocardial Remodelling
    |- MCG Tertiary Analysis: Myocardial Remodelling
        |- auto power spectrum V5: A5 (1.0)
        |- phase shift angle (V5,II): P+ (1.0)
        |- phase shift angle (V5,II): P- (1.0)
        |- phase shift angle (V5,II): WW (1.0)
        |- impulse response (V5,II): M3 (1.0)
 |- Increased Myocardial Compliance
    |- MCG Tertiary Analysis: Increased Myocardial Compliance
        |- impulse response (V5,II): M3 (1.0)
 |- Signal B lags behind signal A (global)
    |- MCG Tertiary Analysis: Signal B lags behind signal A (global)
 |- Global Asynchrony
    |- MCG Tertiary Analysis: Global Asynchrony
        |- phase shift angle : P- (1.0)
        |- phase shift angle : P+ (1.0)
        |- MCG Tertiary Analysis: Signal B lags behind signal A (global)
ecg_2
 |- Impression (text)
    |- MCG Primary Analysis: Impression (text)
        |- MCG Impression Analysis: Impression (text)
                |- MCG Impression Analysis: Impression
                                |- MCG Impression Analysis: Abnormal
                                                                |- auto power spectrum V5: A5 (10.0)
                                                                |- phase shift angle : P+ (10.0)
                                                                |- phase shift angle : P- (10.0)
                                                                |- phase shift angle : WW (10.0)
 |- Disease Severity
    |- MCG Primary Analysis: Disease Severity
        |- MCG Disease Severity Analysis: Disease Severity Score
                |- impulse response (V5,II): Bat1 (1.0)
                |- cross correlation (V5,II): Snail1 (1.0)
                |- phase shift angle (V5,II): Dragon1 (1.0)
                |- auto power spectrum II: Camel1 (1.0)
 |- Disease Severity Adjusted Score
    |- MCG Primary Analysis: Disease Severity Adjusted Score
        |- MCG Disease Severity Analysis: Disease Severity Adjusted Score
                |- auto power spectrum II: Camel1 (1.0)
                |- cross correlation (V5,II): Snail1a (1.0)
                |- cross correlation (V5,II): Snail1b (1.0)
                |- cross correlation (V5,II): Snail1c (1.0)
                |- impulse response (V5,II): Bat1a (1.0)
                |- impulse response (V5,II): Bat1b (1.0)
                |- phase shift angle (V5,II): Dragon1a (1.0)
                |- phase shift angle (V5,II): Dragon1b (1.0)
 |- Myocardial Infarct
    |- MCG Secondary Analysis: Myocardial Infarct
        |- phase shift angle (V5,II): WW (1.0)
        |- cross correlation (V5,II): Rn (1.0)
        |- MCG Preliminary Analysis: Myocardial Infarct
 |- Ventricular Hypertrophy
    |- MCG Secondary Analysis: Ventricular Hypertrophy
        |- auto power spectrum V5: A5 (1.0)
        |- MCG Preliminary Analysis: Ventricular Hypertrophy
        |- MCG Secondary Analysis: Left Ventricular Hypertrophy
 |- Left Ventricular Hypertrophy
    |- MCG Secondary Analysis: Left Ventricular Hypertrophy
 |- Congenital HD
    |- MCG Secondary Analysis: Congenital HD
        |- MCG Preliminary Analysis: Congenital HD
 |- Rheumatic HD
    |- MCG Secondary Analysis: Rheumatic HD
        |- MCG Preliminary Analysis: Rheumatic HD
 |- Myocarditis
    |- MCG Secondary Analysis: Myocarditis
        |- MCG Preliminary Analysis: Myocarditis
 |- Myocardial Remodelling
    |- MCG Tertiary Analysis: Myocardial Remodelling
        |- auto power spectrum V5: A5 (1.0)
        |- phase shift angle (V5,II): P+ (1.0)
        |- phase shift angle (V5,II): P- (1.0)
        |- phase shift angle (V5,II): WW (1.0)
        |- impulse response (V5,II): M3 (1.0)
 |- Increased Myocardial Compliance
    |- MCG Tertiary Analysis: Increased Myocardial Compliance
        |- impulse response (V5,II): M3 (1.0)
 |- Signal B lags behind signal A (global)
    |- MCG Tertiary Analysis: Signal B lags behind signal A (global)
 |- Global Asynchrony
    |- MCG Tertiary Analysis: Global Asynchrony
        |- phase shift angle : P- (1.0)
        |- phase shift angle : P+ (1.0)
        |- MCG Tertiary Analysis: Signal B lags behind signal A (global)
ecg_3
 |- Impression (text)
    |- MCG Primary Analysis: Impression (text)
        |- MCG Impression Analysis: Impression (text)
                |- MCG Impression Analysis: Impression
                                |- MCG Impression Analysis: Abnormal
                                                                |- auto power spectrum V5: A5 (10.0)
                                                                |- phase shift angle : P+ (10.0)
                                                                |- phase shift angle : P- (10.0)
                                                                |- phase shift angle : WW (10.0)
 |- Disease Severity
    |- MCG Primary Analysis: Disease Severity
        |- MCG Disease Severity Analysis: Disease Severity Score
                |- impulse response (V5,II): Bat1 (1.0)
                |- cross correlation (V5,II): Snail1 (1.0)
                |- phase shift angle (V5,II): Dragon1 (1.0)
                |- auto power spectrum II: Camel1 (1.0)
 |- Disease Severity Adjusted Score
    |- MCG Primary Analysis: Disease Severity Adjusted Score
        |- MCG Disease Severity Analysis: Disease Severity Adjusted Score
                |- auto power spectrum II: Camel1 (1.0)
                |- cross correlation (V5,II): Snail1a (1.0)
                |- cross correlation (V5,II): Snail1b (1.0)
                |- cross correlation (V5,II): Snail1c (1.0)
                |- impulse response (V5,II): Bat1a (1.0)
                |- impulse response (V5,II): Bat1b (1.0)
                |- phase shift angle (V5,II): Dragon1a (1.0)
                |- phase shift angle (V5,II): Dragon1b (1.0)
 |- Myocardial Infarct
    |- MCG Secondary Analysis: Myocardial Infarct
        |- phase shift angle (V5,II): WW (1.0)
        |- cross correlation (V5,II): Rn (1.0)
        |- MCG Preliminary Analysis: Myocardial Infarct
 |- Ventricular Hypertrophy
    |- MCG Secondary Analysis: Ventricular Hypertrophy
        |- auto power spectrum V5: A5 (1.0)
        |- MCG Preliminary Analysis: Ventricular Hypertrophy
        |- MCG Secondary Analysis: Left Ventricular Hypertrophy
 |- Left Ventricular Hypertrophy
    |- MCG Secondary Analysis: Left Ventricular Hypertrophy
 |- Congenital HD
    |- MCG Secondary Analysis: Congenital HD
        |- MCG Preliminary Analysis: Congenital HD
 |- Rheumatic HD
    |- MCG Secondary Analysis: Rheumatic HD
        |- MCG Preliminary Analysis: Rheumatic HD
 |- Myocarditis
    |- MCG Secondary Analysis: Myocarditis
        |- MCG Preliminary Analysis: Myocarditis
 |- Myocardial Remodelling
    |- MCG Tertiary Analysis: Myocardial Remodelling
        |- auto power spectrum V5: A5 (1.0)
        |- phase shift angle (V5,II): P+ (1.0)
        |- phase shift angle (V5,II): P- (1.0)
        |- phase shift angle (V5,II): WW (1.0)
        |- impulse response (V5,II): M3 (1.0)
 |- Increased Myocardial Compliance
    |- MCG Tertiary Analysis: Increased Myocardial Compliance
        |- impulse response (V5,II): M3 (1.0)
 |- Signal B lags behind signal A (global)
    |- MCG Tertiary Analysis: Signal B lags behind signal A (global)
 |- Global Asynchrony
    |- MCG Tertiary Analysis: Global Asynchrony
        |- phase shift angle : P- (1.0)
        |- phase shift angle : P+ (1.0)
        |- MCG Tertiary Analysis: Signal B lags behind signal A (global)

